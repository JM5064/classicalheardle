<!DOCTYPE html>
<html>
    <head>
      <title>Classical Music Heardle</title>

      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
      
      <link rel="stylesheet" href="website.css">

    </head>

    <body>
      <div id="guesses-list"></div>

      <p class="title">
        Classicle
      </p>
      <div id="g1" class="guess1"></div>
      <div id="g2" class="guess2"></div>
      <div id="g3" class="guess3"></div>
      <div id="g4" class="guess4"></div>
      <div id="g5" class="guess5"></div>
      <div id="g6" class="guess6"></div>
      
      <div>
        <audio controls src="Mzg1ODMxNTIzMzg1ODM3_JzthsfvUY24.MP3">

        </audio>
      </div>
      
      <form autocomplete="off">
      <div>
        <input type="text" id="guess-input" class="search" placeholder="Guess Piece" 
        >
      </div>
      </form>

      <div>
        <button id="skip-button" onclick="addGuess('S K I P P E D'); 
          render_skip_time();"
        class="skip">
          SKIP (+1s)
        </button>  
      </div>

      <div>
        <button onclick="addGuess(document.getElementById('guess-input').value); 
        render_skip_time();
        document.getElementById('guess-input').value = '';
        "  class="submit">
          SUBMIT
        </button>  
      </div>

      

      <script>
        let guesses = [];
        let numGuesses = 0;
        pieces = [
          "Partita No. 2, Chaconne - J.S. Bach",
          "Rondo Alla Turca - Wolfang Amadeus Mozart",
          "Hungarian Rhapsody No. 2 - Franz Liszt",
          "Academic Festival Overture - Johannes Brahms",
          "Violin Concerto No. 1 in G minor - Max Bruch",
          "Piano Concerto No. 1 - Pyotr Ilyich Tchaikovsky",
          "Violin Concerto in D Major - Pyotr Ilyich Tchaikovsky",
          "Symphony No. 4 in F minor - Pyotr Ilyich Tchaikovsky",
          "Symphony No. 5 in E minor - Pyotr Ilyich Tchaikovsky",
          "Symphony No. 6 in B minor - Pyotr Ilyich Tchaikovsky",
          "1812 Overture - Pyotr Ilyich Tchaikovsky",
          "Capriccio Espangol - Nikolai Rimsky-Korsakov",
          "Flight of the Bumblebee - Nikolai Rimsky-Korsakov",
          "Navarra - Pablo de Sarasate",
          "Zigeunerweisen - Pablo de Sarasate",
          "Zapateado - Pablo de Sarasate",
          "Maple Leaf Rag - Scott Joplin",
          "Piano Concerto No. 2 - Sergei Rachmaninoff",
          "Prelude in G minor - Sergei Rachmaninoff",
          "Symphony No. 2 in E minor - Sergei Rachmaninoff",
          "Symphonic Dances - Sergei Rachmaninoff"];


        function closeAutofill() {
          let divs = document.getElementsByClassName("autocomplete-items");
          let l = divs.length;
          for (let i = 0; i < l; i++) {
            divs[0].parentNode.removeChild(divs[0]);
          }
        }

        autofill(document.getElementById("guess-input"));

        function autofill(input){

          input.addEventListener("input", function(e) {
            closeAutofill();
            // var a, b, i, val = this.value;
            // console.log(a + " " + b + " " + i + " " + val);
            console.log(this.value);
          
            for (let i = 0; i < pieces.length; i++) {
              // console.log("hi");

              if (document.getElementById('guess-input').value == '') {
                closeAutofill();
                break;
              }
              else if (pieces[i].toUpperCase().includes(document.getElementById('guess-input').value.toUpperCase())) {                
                e = document.createElement('div');
                e.setAttribute("class", "autocomplete-items");
                e2 = document.createElement('div');
                e2.setAttribute("class", "autocomplete-items-text");
                
                let piece = pieces[i].toUpperCase();
                let guess = document.getElementById('guess-input').value.toUpperCase();

                e2.innerHTML = pieces[i].substring(0, piece.indexOf(guess));
                e2.innerHTML += "<strong>" + pieces[i].substring(piece.indexOf(guess), piece.indexOf(guess) + guess.length) + "</strong>";
                e2.innerHTML += pieces[i].substring(piece.indexOf(guess) + guess.length);

                e.appendChild(e2);
                document.body.appendChild(e);

                e2.addEventListener("click", function(e) {
                  document.getElementById('guess-input').value = pieces[i];
                  closeAutofill();
                });
              }
            }
         });
         
        }

        function render_guesses() {
          document.getElementById("guesses-list").innerHTML = '';

          // guesses.forEach(
          //   function g (guess) {
          //     // let element = document.createElement('div');
          //     // let element = document.getElementsByClassName('guess1')
          //     document.getElementById('g1').textContent += guess;
          //     // element.textContent += guess;
          //     // element.innerHTML = guess;
          //     // let guessesList = document.getElementById('guesses-list');
          //     // guessesList.appendChild(element);
          //   }
          // );
          document.getElementById('g' + guesses.length).textContent += guesses[guesses.length - 1];
        
        }

        function addGuess(guess) {
          if (numGuesses < 6 && guess != '') {
            guesses.push(guess);
            render_guesses();
            numGuesses++; 
          }
        }

        function render_skip_time() {
          document.getElementById('skip-button').innerHTML = '';
          if (numGuesses < 5) {
            document.getElementById('skip-button').textContent = 'SKIP (+' + (numGuesses + 1) + "s)";
          } else {
            document.getElementById('skip-button').textContent = 'SKIP';
          }
        }


      </script>


    </body>
</html>
